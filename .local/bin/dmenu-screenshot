#!/bin/bash

DMENU="/usr/local/bin/dmenu"

captureFullScreen() {
    $HOME/bin/scrot-full
}

captureFullScreenPlus() {
    $HOME/bin/scrot-full
    $HOME/bin/scrot-mac
}

captureFullScreenTime() {
    $HOME/bin/scrot-time
}

captureWindow() {
    $HOME/bin/scrot-window
}

captureWindowPlus() {
    $HOME/bin/scrot-window-imgck
}

captureFlameshot() {
    /usr/bin/flameshot gui
}

captureFlameshotPlus() {
    $HOME/bin/flameshot-imgck
}

captureFlameshotTime() {
    sleep 3
    $HOME/bin/flameshot-imgck
}

cropLaptop() {
    $HOME/bin/imgmagick-crop-laptop $1
}

cropMonitor() {
    $HOME/bin/imgmagick-crop-monitor $1
}

monitors=$(xrandr --listmonitors | grep 'Monitors:' | tr -d "Monitors: ")

# menu name         function name
OPTIONS='''[
["Fullscreen",      "captureFullScreen"],
["Fullscreen+",     "captureFullScreenPlus"],
["Fullscreen Time", "captureFullScreenTime"],
["Window",          "captureWindow"],
["Window+",         "captureWindowPlus"],
["Flameshot",       "captureFlameshot"],
["Flameshot+",      "captureFlameshotPlus"],
["Flameshot Time",  "captureFlameshotTime"]
]'''

if [ "$monitors" = "2" ]; then
    OPTIONS+='''[
    ["Crop Laptop",     "cropLaptop '1024x768+576+900'"],
    ["Crop Monitor",    "cropMonitor '1600x900+0+0'"]
    ]'''
fi

obj=$(echo $OPTIONS | jq -r ".[][0]" | $DMENU -i -p "ï€° ScreenShot:")
$(echo $OPTIONS | jq -r ".[] | select(.[0] == '$obj') | .[1]")
